(()=>{"use strict";class e{constructor(e){this.keyApi="AIzaSyAE5jaE7bqtkhrmoHAM6estHSniStTI42A",this.startIndex=0,this.maxResults=6,this.listBooks=e,this.listBooks.innerHTML=""}getBooks(e){fetch('https://www.googleapis.com/books/v1/volumes?q="subject:'+e+'"&key='+this.keyApi+"&printType=books&startIndex="+this.startIndex+"&maxResults="+this.maxResults).then((e=>e.json())).then((e=>{this.paint(e.items),this.startIndex=+this.maxResults})).catch((e=>{console.log("error",e)}))}paint(e){e.forEach((e=>{let t=document.createElement("img");t.classList.add("book-card__img"),e.volumeInfo.imageLinks.thumbnail?t.setAttribute("src",e.volumeInfo.imageLinks.thumbnail):t.setAttribute("src","./src/images/not_img.png"),t.setAttribute("alt",e.volumeInfo.imageLinks.title);let o=document.createElement("div");if(o.classList.add("book-card__info"),e.volumeInfo.authors&&e.volumeInfo.authors.length>0){let t=document.createElement("div");o.classList.add("book-card-info__authors");let i="";e.volumeInfo.authors.forEach((e=>{i=i?i+", "+e:e})),t.innerText=i,o.appendChild(t)}let i=document.createElement("div");if(i.classList.add("book-card-info__title"),i.innerText=e.volumeInfo.title,o.appendChild(i),e.volumeInfo.description||e.volumeInfo.ratingsCount){let t=document.createElement("div");if(t.classList.add("book-card-info__ratings"),e.volumeInfo.averageRating){let o=document.createElement("div");o.classList.add("rating_block"),t.appendChild(o);let i=document.createElement("div");i.classList.add("rating_active");let s=e.volumeInfo.averageRating/.05;i.style.width=`${s}%`,o.appendChild(i)}if(e.volumeInfo.ratingsCount){let o=document.createElement("span");o.classList.add("rating_review"),o.innerText=e.volumeInfo.ratingsCount+" review",t.appendChild(o)}o.appendChild(t)}if(e.volumeInfo.description){let t=document.createElement("div");t.classList.add("book-card-info__description"),t.innerText=e.volumeInfo.description,o.appendChild(t)}if(e.saleInfo.retailPrice){let t=document.createElement("div");t.classList.add("book-card-info__price");let i="";switch(e.saleInfo.retailPrice.currencyCode){case"USD":i="$";break;case"RUB":i="â‚½"}t.innerText=i+e.saleInfo.retailPrice.amount,o.appendChild(t)}let s=document.createElement("button");s.classList.add("button"),s.classList.add("book-card-info__button"),s.innerText="buy now",s.setAttribute("id",e.id),s.addEventListener("click",this.buyBook),o.appendChild(s);let n=document.createElement("div");n.classList.add("book-card"),n.appendChild(t),n.appendChild(o),this.listBooks.appendChild(n)}))}buyBook(e){let t=e.target.id,o=JSON.parse(localStorage.getItem("BooksShopBag"));if(o&&o.constructor===Array){let e=o.indexOf(t);-1!==e?o.splice(e,1):o.push(t)}else o=[t];let i=o.length;i?document.querySelectorAll(".shop-bag__counter").forEach((e=>{e.innerText=i,e.classList.remove("hidden")})):document.querySelectorAll(".shop-bag__counter").forEach((e=>{e.innerText="",e.classList.add("hidden")})),localStorage.setItem("BooksShopBag",JSON.stringify(o))}getCategoriesBooks(e){this.startIndex=0,this.listBooks.innerHTML="",this.getBooks(e)}}let t=document.querySelector(".hamburger");t&&t.addEventListener("click",(function(e){document.querySelector(".mobile-nav").classList.toggle("hidden")}));let o=JSON.parse(localStorage.getItem("BooksShopBag"));o&&o.length&&document.querySelectorAll(".shop-bag__counter").forEach((e=>{e.innerText=o.length,e.classList.remove("hidden")}));let i=document.querySelector(".slider");if(i){function n(){let e=this.id.split("_"),t=i.querySelector("#banner_"+e[1]);t&&(i.querySelectorAll(".slider-dots__dot").forEach((e=>{e.classList.remove("active")})),i.querySelectorAll(".slider-banners__img").forEach((e=>{e.classList.remove("active")})),t.classList.add("active"),this.classList.add("active"))}i.querySelectorAll(".slider-dots__dot").forEach((e=>{e.addEventListener("click",n)}))}let s=document.querySelector(".books-block");if(s){const l=new e(document.querySelector(".list-books-block"));function a(e){let t=e.target;t&&(s.querySelectorAll(".categories-list__item").forEach((e=>{e.classList.remove("active")})),t.parentElement.classList.add("active"),l.getCategoriesBooks(t.innerText))}function r(){let e=s.querySelector(".categories-list__item.active span");e&&l.getBooks(e.innerText)}s.querySelectorAll(".categories-list__item").forEach((e=>{e.addEventListener("click",a)})),document.querySelector(".load-more").addEventListener("click",r),r()}})();